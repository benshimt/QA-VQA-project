datasets
datasets
datasets
datasets
datasets
datasets
datasets
datasets
datasets
datasets
finish imports
finish parsing

Namespace(model_parallel=True, model_name='opt-1.3b', seed=4, prompt_text='', max_length=128, batch_size=8, epoch=16, lr=5e-06, time_stamp='2023-11-28_12-40-38', test_only='False', scale=32, model_path='', loss_rate=1.0, token_loss=0)


************************************************************
start train...
************************************************************

The time stamp is 2023-11-28_12-40-38
load data start.
load data done.
data process start.
Map:   0%|                                                                                               | 0/64 [00:00<?, ? examples/s]Map: 100%|████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 1751.95 examples/s]
Map:   0%|                                                                                               | 0/64 [00:00<?, ? examples/s]Map: 100%|████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 1276.27 examples/s]
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
data process done.
model load start.
cuda
model load done.
set training arguments start.
set training arguments done.
data collator load start.
data collator load done.
trainer load start.
trainer load done.
model training start.
  0%|                                                                                                          | 0/128 [00:00<?, ?it/s]  1%|▊                                                                                                 | 1/128 [00:01<02:28,  1.17s/it]  2%|█▌                                                                                                | 2/128 [00:01<01:35,  1.32it/s]  2%|██▎                                                                                               | 3/128 [00:02<01:17,  1.61it/s]  3%|███                                                                                               | 4/128 [00:02<01:09,  1.79it/s]  4%|███▊                                                                                              | 5/128 [00:03<01:04,  1.92it/s]  5%|████▌                                                                                             | 6/128 [00:03<01:00,  2.00it/s]  5%|█████▎                                                                                            | 7/128 [00:03<00:58,  2.05it/s]  6%|██████▏                                                                                           | 8/128 [00:04<00:57,  2.09it/s]
  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.59it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.43it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.46it/s][A                                                                                                                                       
                                                                                                                                       [A  6%|██████▏                                                                                           | 8/128 [00:05<00:57,  2.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.46it/s][A
                                                                                                                                       [A  7%|██████▉                                                                                           | 9/128 [01:08<40:36, 20.48s/it]  8%|███████▌                                                                                         | 10/128 [01:09<28:07, 14.30s/it]  9%|████████▎                                                                                        | 11/128 [01:09<19:37, 10.06s/it]  9%|█████████                                                                                        | 12/128 [01:10<13:48,  7.14s/it] 10%|█████████▊                                                                                       | 13/128 [01:10<09:48,  5.12s/it] 11%|██████████▌                                                                                      | 14/128 [01:11<07:02,  3.71s/it] 12%|███████████▎                                                                                     | 15/128 [01:11<05:08,  2.73s/it] 12%|████████████▏                                                                                    | 16/128 [01:12<03:49,  2.04s/it]{'eval_loss': 3.5104806423187256, 'eval_runtime': 0.7696, 'eval_samples_per_second': 83.156, 'eval_steps_per_second': 10.395, 'epoch': 1.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.55it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.42it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.45it/s][A                                                                                                                                       
                                                                                                                                       [A 12%|████████████▏                                                                                    | 16/128 [01:12<03:49,  2.04s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.45it/s][A
                                                                                                                                       [A 13%|████████████▉                                                                                    | 17/128 [02:29<45:39, 24.68s/it] 14%|█████████████▋                                                                                   | 18/128 [02:29<31:54, 17.40s/it] 15%|██████████████▍                                                                                  | 19/128 [02:30<22:22, 12.31s/it] 16%|███████████████▏                                                                                 | 20/128 [02:30<15:45,  8.75s/it] 16%|███████████████▉                                                                                 | 21/128 [02:31<11:10,  6.27s/it] 17%|████████████████▋                                                                                | 22/128 [02:31<07:59,  4.52s/it] 18%|█████████████████▍                                                                               | 23/128 [02:32<05:46,  3.30s/it] 19%|██████████████████▏                                                                              | 24/128 [02:32<04:15,  2.45s/it]{'eval_loss': 3.0590150356292725, 'eval_runtime': 0.7716, 'eval_samples_per_second': 82.95, 'eval_steps_per_second': 10.369, 'epoch': 2.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.56it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.49it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.41it/s][A                                                                                                                                       
                                                                                                                                       [A 19%|██████████████████▏                                                                              | 24/128 [02:33<04:15,  2.45s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.41it/s][A
                                                                                                                                       [A 20%|██████████████████▉                                                                              | 25/128 [03:40<37:44, 21.99s/it] 20%|███████████████████▋                                                                             | 26/128 [03:40<26:24, 15.53s/it] 21%|████████████████████▍                                                                            | 27/128 [03:41<18:32, 11.02s/it] 22%|█████████████████████▏                                                                           | 28/128 [03:41<13:05,  7.85s/it] 23%|█████████████████████▉                                                                           | 29/128 [03:42<09:17,  5.63s/it] 23%|██████████████████████▋                                                                          | 30/128 [03:42<06:40,  4.08s/it] 24%|███████████████████████▍                                                                         | 31/128 [03:42<04:51,  3.01s/it] 25%|████████████████████████▎                                                                        | 32/128 [03:43<03:36,  2.25s/it]{'eval_loss': 2.6174747943878174, 'eval_runtime': 0.7739, 'eval_samples_per_second': 82.696, 'eval_steps_per_second': 10.337, 'epoch': 3.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.39it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.37it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.38it/s][A                                                                                                                                       
                                                                                                                                       [A 25%|████████████████████████▎                                                                        | 32/128 [03:44<03:36,  2.25s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.38it/s][A
                                                                                                                                       [A 26%|█████████████████████████                                                                        | 33/128 [04:58<38:01, 24.02s/it] 27%|█████████████████████████▊                                                                       | 34/128 [04:58<26:33, 16.95s/it] 27%|██████████████████████████▌                                                                      | 35/128 [04:59<18:36, 12.00s/it] 28%|███████████████████████████▎                                                                     | 36/128 [04:59<13:05,  8.54s/it] 29%|████████████████████████████                                                                     | 37/128 [05:00<09:16,  6.11s/it] 30%|████████████████████████████▊                                                                    | 38/128 [05:00<06:37,  4.42s/it] 30%|█████████████████████████████▌                                                                   | 39/128 [05:01<04:47,  3.23s/it] 31%|██████████████████████████████▎                                                                  | 40/128 [05:01<03:30,  2.40s/it]{'eval_loss': 2.1359670162200928, 'eval_runtime': 0.7758, 'eval_samples_per_second': 82.495, 'eval_steps_per_second': 10.312, 'epoch': 4.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.55it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.46it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.41it/s][A                                                                                                                                       
                                                                                                                                       [A 31%|██████████████████████████████▎                                                                  | 40/128 [05:02<03:30,  2.40s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.41it/s][A
                                                                                                                                       [A 32%|███████████████████████████████                                                                  | 41/128 [06:07<31:17, 21.58s/it] 33%|███████████████████████████████▊                                                                 | 42/128 [06:08<21:50, 15.24s/it] 34%|████████████████████████████████▌                                                                | 43/128 [06:08<15:18, 10.81s/it] 34%|█████████████████████████████████▎                                                               | 44/128 [06:09<10:46,  7.70s/it] 35%|██████████████████████████████████                                                               | 45/128 [06:09<07:39,  5.53s/it] 36%|██████████████████████████████████▊                                                              | 46/128 [06:10<05:28,  4.01s/it] 37%|███████████████████████████████████▌                                                             | 47/128 [06:10<03:58,  2.95s/it] 38%|████████████████████████████████████▍                                                            | 48/128 [06:11<02:55,  2.20s/it]{'eval_loss': 2.0106730461120605, 'eval_runtime': 0.7697, 'eval_samples_per_second': 83.145, 'eval_steps_per_second': 10.393, 'epoch': 5.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.63it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.43it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.41it/s][A                                                                                                                                       
                                                                                                                                       [A 38%|████████████████████████████████████▍                                                            | 48/128 [06:11<02:55,  2.20s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.41it/s][A
                                                                                                                                       [A 38%|█████████████████████████████████████▏                                                           | 49/128 [07:42<38:10, 29.00s/it] 39%|█████████████████████████████████████▉                                                           | 50/128 [07:43<26:34, 20.44s/it] 40%|██████████████████████████████████████▋                                                          | 51/128 [07:43<18:32, 14.45s/it] 41%|███████████████████████████████████████▍                                                         | 52/128 [07:43<12:59, 10.26s/it] 41%|████████████████████████████████████████▏                                                        | 53/128 [07:44<09:09,  7.32s/it] 42%|████████████████████████████████████████▉                                                        | 54/128 [07:44<06:29,  5.27s/it] 43%|█████████████████████████████████████████▋                                                       | 55/128 [07:45<04:39,  3.83s/it] 44%|██████████████████████████████████████████▍                                                      | 56/128 [07:45<03:23,  2.82s/it]{'eval_loss': 1.9908746480941772, 'eval_runtime': 0.7721, 'eval_samples_per_second': 82.89, 'eval_steps_per_second': 10.361, 'epoch': 6.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.32it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.40it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.43it/s][A                                                                                                                                       
                                                                                                                                       [A 44%|██████████████████████████████████████████▍                                                      | 56/128 [07:46<03:23,  2.82s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.43it/s][A
                                                                                                                                       [A 45%|███████████████████████████████████████████▏                                                     | 57/128 [09:11<32:45, 27.68s/it] 45%|███████████████████████████████████████████▉                                                     | 58/128 [09:12<22:46, 19.52s/it] 46%|████████████████████████████████████████████▋                                                    | 59/128 [09:12<15:52, 13.80s/it] 47%|█████████████████████████████████████████████▍                                                   | 60/128 [09:12<11:06,  9.80s/it] 48%|██████████████████████████████████████████████▏                                                  | 61/128 [09:13<07:48,  7.00s/it] 48%|██████████████████████████████████████████████▉                                                  | 62/128 [09:13<05:32,  5.04s/it] 49%|███████████████████████████████████████████████▋                                                 | 63/128 [09:14<03:58,  3.66s/it] 50%|████████████████████████████████████████████████▌                                                | 64/128 [09:14<02:52,  2.70s/it]{'eval_loss': 2.0321922302246094, 'eval_runtime': 0.7742, 'eval_samples_per_second': 82.669, 'eval_steps_per_second': 10.334, 'epoch': 7.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.54it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.46it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.41it/s][A                                                                                                                                       
                                                                                                                                       [A 50%|████████████████████████████████████████████████▌                                                | 64/128 [09:15<02:52,  2.70s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.41it/s][A
                                                                                                                                       [A 51%|█████████████████████████████████████████████████▎                                               | 65/128 [10:33<26:48, 25.54s/it] 52%|██████████████████████████████████████████████████                                               | 66/128 [10:34<18:37, 18.02s/it] 52%|██████████████████████████████████████████████████▊                                              | 67/128 [10:34<12:57, 12.75s/it] 53%|███████████████████████████████████████████████████▌                                             | 68/128 [10:35<09:04,  9.07s/it] 54%|████████████████████████████████████████████████████▎                                            | 69/128 [10:35<06:22,  6.49s/it] 55%|█████████████████████████████████████████████████████                                            | 70/128 [10:35<04:31,  4.68s/it] 55%|█████████████████████████████████████████████████████▊                                           | 71/128 [10:36<03:14,  3.42s/it] 56%|██████████████████████████████████████████████████████▌                                          | 72/128 [10:36<02:22,  2.54s/it]{'eval_loss': 2.0285046100616455, 'eval_runtime': 0.7732, 'eval_samples_per_second': 82.771, 'eval_steps_per_second': 10.346, 'epoch': 8.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.49it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.39it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.42it/s][A                                                                                                                                       
                                                                                                                                       [A 56%|██████████████████████████████████████████████████████▌                                          | 72/128 [10:37<02:22,  2.54s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.42it/s][A
                                                                                                                                       [A 57%|███████████████████████████████████████████████████████▎                                         | 73/128 [11:44<20:18, 22.15s/it] 58%|████████████████████████████████████████████████████████                                         | 74/128 [11:45<14:04, 15.65s/it] 59%|████████████████████████████████████████████████████████▊                                        | 75/128 [11:45<09:48, 11.10s/it] 59%|█████████████████████████████████████████████████████████▌                                       | 76/128 [11:46<06:51,  7.91s/it] 60%|██████████████████████████████████████████████████████████▎                                      | 77/128 [11:46<04:49,  5.68s/it] 61%|███████████████████████████████████████████████████████████                                      | 78/128 [11:47<03:25,  4.12s/it] 62%|███████████████████████████████████████████████████████████▊                                     | 79/128 [11:47<02:27,  3.02s/it] 62%|████████████████████████████████████████████████████████████▋                                    | 80/128 [11:48<01:48,  2.25s/it]{'eval_loss': 2.076850175857544, 'eval_runtime': 0.774, 'eval_samples_per_second': 82.687, 'eval_steps_per_second': 10.336, 'epoch': 9.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.37it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.35it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.39it/s][A                                                                                                                                       
                                                                                                                                       [A 62%|████████████████████████████████████████████████████████████▋                                    | 80/128 [11:48<01:48,  2.25s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.39it/s][A
                                                                                                                                       [A 63%|█████████████████████████████████████████████████████████████▍                                   | 81/128 [13:03<19:02, 24.32s/it] 64%|██████████████████████████████████████████████████████████████▏                                  | 82/128 [13:04<13:09, 17.16s/it] 65%|██████████████████████████████████████████████████████████████▉                                  | 83/128 [13:04<09:06, 12.15s/it] 66%|███████████████████████████████████████████████████████████████▋                                 | 84/128 [13:05<06:20,  8.64s/it] 66%|████████████████████████████████████████████████████████████████▍                                | 85/128 [13:05<04:26,  6.19s/it] 67%|█████████████████████████████████████████████████████████████████▏                               | 86/128 [13:06<03:07,  4.47s/it] 68%|█████████████████████████████████████████████████████████████████▉                               | 87/128 [13:06<02:14,  3.27s/it] 69%|██████████████████████████████████████████████████████████████████▋                              | 88/128 [13:07<01:37,  2.43s/it]{'eval_loss': 2.0985636711120605, 'eval_runtime': 0.7761, 'eval_samples_per_second': 82.469, 'eval_steps_per_second': 10.309, 'epoch': 10.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.38it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.36it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.31it/s][A                                                                                                                                       
                                                                                                                                       [A 69%|██████████████████████████████████████████████████████████████████▋                              | 88/128 [13:07<01:37,  2.43s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.31it/s][A
                                                                                                                                       [A 70%|███████████████████████████████████████████████████████████████████▍                             | 89/128 [14:14<14:15, 21.93s/it] 70%|████████████████████████████████████████████████████████████████████▏                            | 90/128 [14:15<09:48, 15.49s/it] 71%|████████████████████████████████████████████████████████████████████▉                            | 91/128 [14:15<06:46, 10.98s/it] 72%|█████████████████████████████████████████████████████████████████████▋                           | 92/128 [14:16<04:41,  7.83s/it] 73%|██████████████████████████████████████████████████████████████████████▍                          | 93/128 [14:16<03:16,  5.62s/it] 73%|███████████████████████████████████████████████████████████████████████▏                         | 94/128 [14:16<02:18,  4.08s/it] 74%|███████████████████████████████████████████████████████████████████████▉                         | 95/128 [14:17<01:38,  2.99s/it] 75%|████████████████████████████████████████████████████████████████████████▊                        | 96/128 [14:17<01:11,  2.24s/it]{'eval_loss': 2.053738594055176, 'eval_runtime': 0.7804, 'eval_samples_per_second': 82.007, 'eval_steps_per_second': 10.251, 'epoch': 11.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.38it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.38it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.41it/s][A                                                                                                                                       
                                                                                                                                       [A 75%|████████████████████████████████████████████████████████████████████████▊                        | 96/128 [14:18<01:11,  2.24s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.41it/s][A
                                                                                                                                       [A 76%|█████████████████████████████████████████████████████████████████████████▌                       | 97/128 [15:30<12:08, 23.49s/it] 77%|██████████████████████████████████████████████████████████████████████████▎                      | 98/128 [15:31<08:17, 16.58s/it] 77%|███████████████████████████████████████████████████████████████████████████                      | 99/128 [15:31<05:40, 11.75s/it] 78%|███████████████████████████████████████████████████████████████████████████                     | 100/128 [15:32<03:54,  8.36s/it]                                                                                                                                        78%|███████████████████████████████████████████████████████████████████████████                     | 100/128 [15:32<03:54,  8.36s/it] 79%|███████████████████████████████████████████████████████████████████████████▊                    | 101/128 [15:32<02:41,  5.99s/it] 80%|████████████████████████████████████████████████████████████████████████████▌                   | 102/128 [15:33<01:52,  4.33s/it] 80%|█████████████████████████████████████████████████████████████████████████████▎                  | 103/128 [15:33<01:19,  3.17s/it] 81%|██████████████████████████████████████████████████████████████████████████████                  | 104/128 [15:34<00:56,  2.36s/it]{'eval_loss': 2.155557870864868, 'eval_runtime': 0.7768, 'eval_samples_per_second': 82.393, 'eval_steps_per_second': 10.299, 'epoch': 12.0}
{'loss': 1.1426, 'learning_rate': 1.0937500000000001e-06, 'epoch': 12.5}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.57it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.46it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.41it/s][A                                                                                                                                       
                                                                                                                                       [A 81%|██████████████████████████████████████████████████████████████████████████████                  | 104/128 [15:34<00:56,  2.36s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.41it/s][A
                                                                                                                                       [A 82%|██████████████████████████████████████████████████████████████████████████████▊                 | 105/128 [16:41<08:24, 21.92s/it] 83%|███████████████████████████████████████████████████████████████████████████████▌                | 106/128 [16:42<05:40, 15.48s/it] 84%|████████████████████████████████████████████████████████████████████████████████▎               | 107/128 [16:42<03:50, 10.98s/it] 84%|█████████████████████████████████████████████████████████████████████████████████               | 108/128 [16:43<02:36,  7.82s/it] 85%|█████████████████████████████████████████████████████████████████████████████████▊              | 109/128 [16:43<01:46,  5.62s/it] 86%|██████████████████████████████████████████████████████████████████████████████████▌             | 110/128 [16:44<01:13,  4.07s/it] 87%|███████████████████████████████████████████████████████████████████████████████████▎            | 111/128 [16:44<00:50,  2.99s/it] 88%|████████████████████████████████████████████████████████████████████████████████████            | 112/128 [16:45<00:35,  2.23s/it]{'eval_loss': 2.216916084289551, 'eval_runtime': 0.7734, 'eval_samples_per_second': 82.75, 'eval_steps_per_second': 10.344, 'epoch': 13.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.42it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.34it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.35it/s][A                                                                                                                                       
                                                                                                                                       [A 88%|████████████████████████████████████████████████████████████████████████████████████            | 112/128 [16:45<00:35,  2.23s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.35it/s][A
                                                                                                                                       [A 88%|████████████████████████████████████████████████████████████████████████████████████▊           | 113/128 [17:56<05:47, 23.15s/it] 89%|█████████████████████████████████████████████████████████████████████████████████████▌          | 114/128 [17:57<03:48, 16.35s/it] 90%|██████████████████████████████████████████████████████████████████████████████████████▎         | 115/128 [17:57<02:30, 11.58s/it] 91%|███████████████████████████████████████████████████████████████████████████████████████         | 116/128 [17:58<01:38,  8.25s/it] 91%|███████████████████████████████████████████████████████████████████████████████████████▊        | 117/128 [17:58<01:05,  5.92s/it] 92%|████████████████████████████████████████████████████████████████████████████████████████▌       | 118/128 [17:59<00:42,  4.28s/it] 93%|█████████████████████████████████████████████████████████████████████████████████████████▎      | 119/128 [17:59<00:28,  3.14s/it] 94%|██████████████████████████████████████████████████████████████████████████████████████████      | 120/128 [18:00<00:18,  2.34s/it]{'eval_loss': 2.193638324737549, 'eval_runtime': 0.7769, 'eval_samples_per_second': 82.379, 'eval_steps_per_second': 10.297, 'epoch': 14.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.22it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.30it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.34it/s][A                                                                                                                                       
                                                                                                                                       [A 94%|██████████████████████████████████████████████████████████████████████████████████████████      | 120/128 [18:01<00:18,  2.34s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.34it/s][A
                                                                                                                                       [A 95%|██████████████████████████████████████████████████████████████████████████████████████████▊     | 121/128 [19:07<02:33, 21.88s/it] 95%|███████████████████████████████████████████████████████████████████████████████████████████▌    | 122/128 [19:08<01:32, 15.46s/it] 96%|████████████████████████████████████████████████████████████████████████████████████████████▎   | 123/128 [19:08<00:54, 10.96s/it] 97%|█████████████████████████████████████████████████████████████████████████████████████████████   | 124/128 [19:09<00:31,  7.82s/it] 98%|█████████████████████████████████████████████████████████████████████████████████████████████▊  | 125/128 [19:09<00:16,  5.61s/it] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▌ | 126/128 [19:10<00:08,  4.07s/it] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▎| 127/128 [19:10<00:02,  2.99s/it]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [19:11<00:00,  2.23s/it]{'eval_loss': 2.1714298725128174, 'eval_runtime': 0.779, 'eval_samples_per_second': 82.153, 'eval_steps_per_second': 10.269, 'epoch': 15.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 38%|█████████████████████████████████████▌                                                              | 3/8 [00:00<00:00, 15.44it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00, 12.36it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:00<00:00, 11.33it/s][A                                                                                                                                       
                                                                                                                                       [A100%|████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [19:11<00:00,  2.23s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 11.33it/s][A
                                                                                                                                       [A                                                                                                                                       100%|████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [21:58<00:00,  2.23s/it]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [22:00<00:00, 10.32s/it]
{'eval_loss': 2.1667888164520264, 'eval_runtime': 0.7799, 'eval_samples_per_second': 82.06, 'eval_steps_per_second': 10.257, 'epoch': 16.0}
{'train_runtime': 1318.6113, 'train_samples_per_second': 0.777, 'train_steps_per_second': 0.097, 'train_loss': 0.9157771989703178, 'epoch': 16.0}
model training done.
saving best model start.
saving best model done.
************************************************************
start test...
************************************************************
Traceback (most recent call last):
  File "/sise/eliorsu-group/Project-11-2023/FalseQA/src/exp-3_opt.py", line 412, in <module>
    test(save_dir)
  File "/sise/eliorsu-group/Project-11-2023/FalseQA/src/exp-3_opt.py", line 315, in test
    model = AutoModelForCausalLM.from_pretrained(model_checkpoint)
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 482, in from_pretrained
    config, kwargs = AutoConfig.from_pretrained(
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py", line 1007, in from_pretrained
    config_dict, unused_kwargs = PretrainedConfig.get_config_dict(pretrained_model_name_or_path, **kwargs)
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/configuration_utils.py", line 620, in get_config_dict
    config_dict, kwargs = cls._get_config_dict(pretrained_model_name_or_path, **kwargs)
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/configuration_utils.py", line 675, in _get_config_dict
    resolved_config_file = cached_file(
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/utils/hub.py", line 399, in cached_file
    raise EnvironmentError(
OSError: ../trained_model/exp-3/train_exp-3_scale-32_opt-1.3b_2023-11-28_12-40-38_4 does not appear to have a file named config.json. Checkout 'https://huggingface.co/../trained_model/exp-3/train_exp-3_scale-32_opt-1.3b_2023-11-28_12-40-38_4/None' for available files.
