datasets
datasets
datasets
datasets
datasets
datasets
datasets
datasets
datasets
datasets
finish imports
finish parsing

Namespace(model_parallel=True, model_name='opt-2.7b', seed=34, prompt_text='', max_length=128, batch_size=8, epoch=16, lr=5e-06, time_stamp='2023-11-28_16-07-25', test_only='False', scale=32, model_path='', loss_rate=1.0, token_loss=0)


************************************************************
start train...
************************************************************

The time stamp is 2023-11-28_16-07-25
load data start.
load data done.
data process start.
Map:   0%|                                                                                               | 0/64 [00:00<?, ? examples/s]Map: 100%|████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 1756.50 examples/s]
Map:   0%|                                                                                               | 0/64 [00:00<?, ? examples/s]Map: 100%|████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 2018.51 examples/s]
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
data process done.
model load start.
cuda
model load done.
set training arguments start.
set training arguments done.
data collator load start.
data collator load done.
trainer load start.
trainer load done.
model training start.
  0%|                                                                                                          | 0/128 [00:00<?, ?it/s]  1%|▊                                                                                                 | 1/128 [00:01<03:46,  1.79s/it]  2%|█▌                                                                                                | 2/128 [00:02<02:42,  1.29s/it]  2%|██▎                                                                                               | 3/128 [00:03<02:21,  1.13s/it]  3%|███                                                                                               | 4/128 [00:04<02:11,  1.06s/it]  4%|███▊                                                                                              | 5/128 [00:05<02:04,  1.01s/it]  5%|████▌                                                                                             | 6/128 [00:06<02:00,  1.01it/s]  5%|█████▎                                                                                            | 7/128 [00:07<01:58,  1.03it/s]  6%|██████▏                                                                                           | 8/128 [00:08<01:56,  1.03it/s]
  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.20it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.44it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  5.93it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.67it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.51it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.40it/s][A                                                                                                                                       
                                                                                                                                       [A  6%|██████▏                                                                                           | 8/128 [00:09<01:56,  1.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.40it/s][A
                                                                                                                                       [A  7%|██████▊                                                                                         | 9/128 [02:40<1:35:24, 48.11s/it]  8%|███████▍                                                                                       | 10/128 [02:41<1:05:58, 33.55s/it]  9%|████████▎                                                                                        | 11/128 [02:42<45:57, 23.57s/it]  9%|█████████                                                                                        | 12/128 [02:42<32:15, 16.69s/it] 10%|█████████▊                                                                                       | 13/128 [02:43<22:50, 11.92s/it] 11%|██████████▌                                                                                      | 14/128 [02:44<16:20,  8.60s/it] 12%|███████████▎                                                                                     | 15/128 [02:45<11:50,  6.29s/it] 12%|████████████▏                                                                                    | 16/128 [02:46<08:44,  4.68s/it]{'eval_loss': 3.406858205795288, 'eval_runtime': 1.5478, 'eval_samples_per_second': 41.349, 'eval_steps_per_second': 5.169, 'epoch': 1.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.20it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.46it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  5.98it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.69it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.51it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.41it/s][A                                                                                                                                       
                                                                                                                                       [A 12%|████████████▏                                                                                    | 16/128 [02:48<08:44,  4.68s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.41it/s][A
                                                                                                                                       [A 13%|████████████▌                                                                                  | 17/128 [05:18<1:30:38, 49.00s/it] 14%|█████████████▎                                                                                 | 18/128 [05:19<1:03:21, 34.55s/it] 15%|██████████████▍                                                                                  | 19/128 [05:20<44:26, 24.46s/it] 16%|███████████████▏                                                                                 | 20/128 [05:21<31:19, 17.40s/it] 16%|███████████████▉                                                                                 | 21/128 [05:22<22:13, 12.46s/it] 17%|████████████████▋                                                                                | 22/128 [05:23<15:54,  9.01s/it] 18%|█████████████████▍                                                                               | 23/128 [05:24<11:31,  6.59s/it] 19%|██████████████████▏                                                                              | 24/128 [05:25<08:28,  4.89s/it]{'eval_loss': 2.8022875785827637, 'eval_runtime': 1.5456, 'eval_samples_per_second': 41.407, 'eval_steps_per_second': 5.176, 'epoch': 2.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.20it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.44it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  5.98it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.71it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.53it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.41it/s][A                                                                                                                                       
                                                                                                                                       [A 19%|██████████████████▏                                                                              | 24/128 [05:26<08:28,  4.89s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.41it/s][A
                                                                                                                                       [A 20%|██████████████████▌                                                                            | 25/128 [07:56<1:23:54, 48.87s/it] 20%|███████████████████▋                                                                             | 26/128 [07:57<58:38, 34.49s/it] 21%|████████████████████▍                                                                            | 27/128 [07:58<41:07, 24.43s/it] 22%|█████████████████████▏                                                                           | 28/128 [07:59<28:58, 17.38s/it] 23%|█████████████████████▉                                                                           | 29/128 [08:00<20:32, 12.45s/it] 23%|██████████████████████▋                                                                          | 30/128 [08:01<14:41,  9.00s/it] 24%|███████████████████████▍                                                                         | 31/128 [08:02<10:38,  6.58s/it] 25%|████████████████████████▎                                                                        | 32/128 [08:03<07:49,  4.89s/it]{'eval_loss': 2.3559086322784424, 'eval_runtime': 1.5541, 'eval_samples_per_second': 41.18, 'eval_steps_per_second': 5.148, 'epoch': 3.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.20it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.45it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  5.99it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.71it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.52it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.41it/s][A                                                                                                                                       
                                                                                                                                       [A 25%|████████████████████████▎                                                                        | 32/128 [08:05<07:49,  4.89s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.41it/s][A
                                                                                                                                       [A 26%|████████████████████████▍                                                                      | 33/128 [10:39<1:19:31, 50.23s/it] 27%|█████████████████████████▊                                                                       | 34/128 [10:40<55:31, 35.44s/it] 27%|██████████████████████████▌                                                                      | 35/128 [10:41<38:53, 25.09s/it] 28%|███████████████████████████▎                                                                     | 36/128 [10:42<27:21, 17.84s/it] 29%|████████████████████████████                                                                     | 37/128 [10:43<19:22, 12.77s/it] 30%|████████████████████████████▊                                                                    | 38/128 [10:44<13:49,  9.22s/it] 30%|█████████████████████████████▌                                                                   | 39/128 [10:45<09:59,  6.73s/it] 31%|██████████████████████████████▎                                                                  | 40/128 [10:46<07:19,  5.00s/it]{'eval_loss': 1.966143012046814, 'eval_runtime': 1.5531, 'eval_samples_per_second': 41.207, 'eval_steps_per_second': 5.151, 'epoch': 4.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.15it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.44it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  5.93it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.65it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.47it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.36it/s][A                                                                                                                                       
                                                                                                                                       [A 31%|██████████████████████████████▎                                                                  | 40/128 [10:47<07:19,  5.00s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.36it/s][A
                                                                                                                                       [A 32%|██████████████████████████████▍                                                                | 41/128 [13:32<1:17:31, 53.46s/it] 33%|███████████████████████████████▊                                                                 | 42/128 [13:33<54:02, 37.71s/it] 34%|████████████████████████████████▌                                                                | 43/128 [13:34<37:47, 26.67s/it] 34%|█████████████████████████████████▎                                                               | 44/128 [13:35<26:32, 18.95s/it] 35%|██████████████████████████████████                                                               | 45/128 [13:36<18:44, 13.55s/it] 36%|██████████████████████████████████▊                                                              | 46/128 [13:37<13:20,  9.77s/it] 37%|███████████████████████████████████▌                                                             | 47/128 [13:38<09:36,  7.12s/it] 38%|████████████████████████████████████▍                                                            | 48/128 [13:39<07:01,  5.26s/it]{'eval_loss': 1.9821221828460693, 'eval_runtime': 1.5656, 'eval_samples_per_second': 40.878, 'eval_steps_per_second': 5.11, 'epoch': 5.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.25it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.49it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  6.01it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.71it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.53it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.42it/s][A                                                                                                                                       
                                                                                                                                       [A 38%|████████████████████████████████████▍                                                            | 48/128 [13:40<07:01,  5.26s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.42it/s][A
                                                                                                                                       [A 38%|████████████████████████████████████▎                                                          | 49/128 [16:23<1:09:45, 52.98s/it] 39%|█████████████████████████████████████▉                                                           | 50/128 [16:24<48:34, 37.37s/it] 40%|██████████████████████████████████████▋                                                          | 51/128 [16:25<33:55, 26.44s/it] 41%|███████████████████████████████████████▍                                                         | 52/128 [16:26<23:47, 18.79s/it] 41%|████████████████████████████████████████▏                                                        | 53/128 [16:27<16:47, 13.43s/it] 42%|████████████████████████████████████████▉                                                        | 54/128 [16:28<11:56,  9.68s/it] 43%|█████████████████████████████████████████▋                                                       | 55/128 [16:29<08:35,  7.06s/it] 44%|██████████████████████████████████████████▍                                                      | 56/128 [16:30<06:16,  5.22s/it]{'eval_loss': 1.9699418544769287, 'eval_runtime': 1.5491, 'eval_samples_per_second': 41.313, 'eval_steps_per_second': 5.164, 'epoch': 6.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.23it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.50it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  5.94it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.68it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.51it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.41it/s][A                                                                                                                                       
                                                                                                                                       [A 44%|██████████████████████████████████████████▍                                                      | 56/128 [16:31<06:16,  5.22s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.41it/s][A
                                                                                                                                       [A 45%|██████████████████████████████████████████▎                                                    | 57/128 [19:09<1:01:02, 51.58s/it] 45%|███████████████████████████████████████████▉                                                     | 58/128 [19:10<42:26, 36.39s/it] 46%|████████████████████████████████████████████▋                                                    | 59/128 [19:11<29:36, 25.75s/it] 47%|█████████████████████████████████████████████▍                                                   | 60/128 [19:12<20:44, 18.31s/it] 48%|██████████████████████████████████████████████▏                                                  | 61/128 [19:13<14:37, 13.10s/it] 48%|██████████████████████████████████████████████▉                                                  | 62/128 [19:14<10:23,  9.45s/it] 49%|███████████████████████████████████████████████▋                                                 | 63/128 [19:15<07:28,  6.90s/it] 50%|████████████████████████████████████████████████▌                                                | 64/128 [19:16<05:26,  5.11s/it]{'eval_loss': 2.0125489234924316, 'eval_runtime': 1.5438, 'eval_samples_per_second': 41.457, 'eval_steps_per_second': 5.182, 'epoch': 7.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.23it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.47it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  6.00it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.71it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.52it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.40it/s][A                                                                                                                                       
                                                                                                                                       [A 50%|████████████████████████████████████████████████▌                                                | 64/128 [19:17<05:26,  5.11s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.40it/s][A
                                                                                                                                       [A 51%|█████████████████████████████████████████████████▎                                               | 65/128 [21:42<49:52, 47.50s/it] 52%|██████████████████████████████████████████████████                                               | 66/128 [21:43<34:39, 33.54s/it] 52%|██████████████████████████████████████████████████▊                                              | 67/128 [21:44<24:09, 23.76s/it] 53%|███████████████████████████████████████████████████▌                                             | 68/128 [21:45<16:54, 16.91s/it] 54%|████████████████████████████████████████████████████▎                                            | 69/128 [21:46<11:55, 12.12s/it] 55%|█████████████████████████████████████████████████████                                            | 70/128 [21:47<08:28,  8.77s/it] 55%|█████████████████████████████████████████████████████▊                                           | 71/128 [21:48<06:06,  6.42s/it] 56%|██████████████████████████████████████████████████████▌                                          | 72/128 [21:49<04:27,  4.78s/it]{'eval_loss': 2.1622657775878906, 'eval_runtime': 1.5531, 'eval_samples_per_second': 41.207, 'eval_steps_per_second': 5.151, 'epoch': 8.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.29it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.51it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  6.01it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.72it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.54it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.42it/s][A                                                                                                                                       
                                                                                                                                       [A 56%|██████████████████████████████████████████████████████▌                                          | 72/128 [21:50<04:27,  4.78s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.42it/s][A
                                                                                                                                       [A 57%|███████████████████████████████████████████████████████▎                                         | 73/128 [24:22<45:14, 49.36s/it] 58%|████████████████████████████████████████████████████████                                         | 74/128 [24:23<31:21, 34.84s/it] 59%|████████████████████████████████████████████████████████▊                                        | 75/128 [24:24<21:47, 24.67s/it] 59%|█████████████████████████████████████████████████████████▌                                       | 76/128 [24:25<15:12, 17.55s/it] 60%|██████████████████████████████████████████████████████████▎                                      | 77/128 [24:26<10:40, 12.57s/it] 61%|███████████████████████████████████████████████████████████                                      | 78/128 [24:27<07:33,  9.08s/it] 62%|███████████████████████████████████████████████████████████▊                                     | 79/128 [24:28<05:25,  6.64s/it] 62%|████████████████████████████████████████████████████████████▋                                    | 80/128 [24:29<03:56,  4.93s/it]{'eval_loss': 2.1548080444335938, 'eval_runtime': 1.5495, 'eval_samples_per_second': 41.304, 'eval_steps_per_second': 5.163, 'epoch': 9.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.33it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.48it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  6.00it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.72it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.53it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.43it/s][A                                                                                                                                       
                                                                                                                                       [A 62%|████████████████████████████████████████████████████████████▋                                    | 80/128 [24:30<03:56,  4.93s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.43it/s][A
                                                                                                                                       [A 63%|█████████████████████████████████████████████████████████████▍                                   | 81/128 [27:05<39:21, 50.24s/it] 64%|██████████████████████████████████████████████████████████████▏                                  | 82/128 [27:06<27:10, 35.44s/it] 65%|██████████████████████████████████████████████████████████████▉                                  | 83/128 [27:07<18:49, 25.09s/it] 66%|███████████████████████████████████████████████████████████████▋                                 | 84/128 [27:08<13:05, 17.84s/it] 66%|████████████████████████████████████████████████████████████████▍                                | 85/128 [27:09<09:09, 12.77s/it] 67%|█████████████████████████████████████████████████████████████████▏                               | 86/128 [27:09<06:27,  9.22s/it] 68%|█████████████████████████████████████████████████████████████████▉                               | 87/128 [27:10<04:36,  6.74s/it] 69%|██████████████████████████████████████████████████████████████████▋                              | 88/128 [27:11<03:20,  5.00s/it]{'eval_loss': 2.1645452976226807, 'eval_runtime': 1.5498, 'eval_samples_per_second': 41.296, 'eval_steps_per_second': 5.162, 'epoch': 10.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.25it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.44it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  5.98it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.70it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.53it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.41it/s][A                                                                                                                                       
                                                                                                                                       [A 69%|██████████████████████████████████████████████████████████████████▋                              | 88/128 [27:13<03:20,  5.00s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.41it/s][A
                                                                                                                                       [A 70%|███████████████████████████████████████████████████████████████████▍                             | 89/128 [29:47<32:31, 50.04s/it] 70%|████████████████████████████████████████████████████████████████████▏                            | 90/128 [29:47<22:21, 35.31s/it] 71%|████████████████████████████████████████████████████████████████████▉                            | 91/128 [29:48<15:24, 24.99s/it] 72%|█████████████████████████████████████████████████████████████████████▋                           | 92/128 [29:49<10:40, 17.78s/it] 73%|██████████████████████████████████████████████████████████████████████▍                          | 93/128 [29:50<07:25, 12.73s/it] 73%|███████████████████████████████████████████████████████████████████████▏                         | 94/128 [29:51<05:12,  9.19s/it] 74%|███████████████████████████████████████████████████████████████████████▉                         | 95/128 [29:52<03:41,  6.71s/it] 75%|████████████████████████████████████████████████████████████████████████▊                        | 96/128 [29:53<02:39,  4.98s/it]{'eval_loss': 2.1993184089660645, 'eval_runtime': 1.5485, 'eval_samples_per_second': 41.33, 'eval_steps_per_second': 5.166, 'epoch': 11.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.25it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.50it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  6.02it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.73it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.53it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.43it/s][A                                                                                                                                       
                                                                                                                                       [A 75%|████████████████████████████████████████████████████████████████████████▊                        | 96/128 [29:55<02:39,  4.98s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.43it/s][A
                                                                                                                                       [A 76%|█████████████████████████████████████████████████████████████████████████▌                       | 97/128 [32:18<24:14, 46.91s/it] 77%|██████████████████████████████████████████████████████████████████████████▎                      | 98/128 [32:19<16:33, 33.12s/it] 77%|███████████████████████████████████████████████████████████████████████████                      | 99/128 [32:20<11:20, 23.47s/it] 78%|███████████████████████████████████████████████████████████████████████████                     | 100/128 [32:21<07:47, 16.71s/it]                                                                                                                                        78%|███████████████████████████████████████████████████████████████████████████                     | 100/128 [32:21<07:47, 16.71s/it] 79%|███████████████████████████████████████████████████████████████████████████▊                    | 101/128 [32:22<05:23, 11.98s/it] 80%|████████████████████████████████████████████████████████████████████████████▌                   | 102/128 [32:23<03:45,  8.67s/it] 80%|█████████████████████████████████████████████████████████████████████████████▎                  | 103/128 [32:23<02:38,  6.35s/it] 81%|██████████████████████████████████████████████████████████████████████████████                  | 104/128 [32:24<01:53,  4.73s/it]{'eval_loss': 2.2538819313049316, 'eval_runtime': 1.5468, 'eval_samples_per_second': 41.376, 'eval_steps_per_second': 5.172, 'epoch': 12.0}
{'loss': 0.966, 'learning_rate': 1.0937500000000001e-06, 'epoch': 12.5}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.23it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.43it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  5.95it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.68it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.49it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.36it/s][A                                                                                                                                       
                                                                                                                                       [A 81%|██████████████████████████████████████████████████████████████████████████████                  | 104/128 [32:26<01:53,  4.73s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.36it/s][A
                                                                                                                                       [A 82%|██████████████████████████████████████████████████████████████████████████████▊                 | 105/128 [34:44<17:22, 45.33s/it] 83%|███████████████████████████████████████████████████████████████████████████████▌                | 106/128 [34:45<11:44, 32.01s/it] 84%|████████████████████████████████████████████████████████████████████████████████▎               | 107/128 [34:46<07:56, 22.69s/it] 84%|█████████████████████████████████████████████████████████████████████████████████               | 108/128 [34:47<05:23, 16.16s/it] 85%|█████████████████████████████████████████████████████████████████████████████████▊              | 109/128 [34:48<03:40, 11.60s/it] 86%|██████████████████████████████████████████████████████████████████████████████████▌             | 110/128 [34:49<02:31,  8.41s/it] 87%|███████████████████████████████████████████████████████████████████████████████████▎            | 111/128 [34:50<01:44,  6.17s/it] 88%|████████████████████████████████████████████████████████████████████████████████████            | 112/128 [34:51<01:13,  4.60s/it]{'eval_loss': 2.2756762504577637, 'eval_runtime': 1.5616, 'eval_samples_per_second': 40.984, 'eval_steps_per_second': 5.123, 'epoch': 13.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.18it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.46it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  6.00it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.72it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.53it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.42it/s][A                                                                                                                                       
                                                                                                                                       [A 88%|████████████████████████████████████████████████████████████████████████████████████            | 112/128 [34:53<01:13,  4.60s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.42it/s][A
                                                                                                                                       [A 88%|████████████████████████████████████████████████████████████████████████████████████▊           | 113/128 [37:15<11:34, 46.32s/it] 89%|█████████████████████████████████████████████████████████████████████████████████████▌          | 114/128 [37:16<07:37, 32.70s/it] 90%|██████████████████████████████████████████████████████████████████████████████████████▎         | 115/128 [37:17<05:01, 23.17s/it] 91%|███████████████████████████████████████████████████████████████████████████████████████         | 116/128 [37:18<03:17, 16.50s/it] 91%|███████████████████████████████████████████████████████████████████████████████████████▊        | 117/128 [37:18<02:10, 11.83s/it] 92%|████████████████████████████████████████████████████████████████████████████████████████▌       | 118/128 [37:19<01:25,  8.56s/it] 93%|█████████████████████████████████████████████████████████████████████████████████████████▎      | 119/128 [37:20<00:56,  6.27s/it] 94%|██████████████████████████████████████████████████████████████████████████████████████████      | 120/128 [37:21<00:37,  4.67s/it]{'eval_loss': 2.301297903060913, 'eval_runtime': 1.5418, 'eval_samples_per_second': 41.509, 'eval_steps_per_second': 5.189, 'epoch': 14.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.28it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.48it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  6.01it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.72it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.54it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.42it/s][A                                                                                                                                       
                                                                                                                                       [A 94%|██████████████████████████████████████████████████████████████████████████████████████████      | 120/128 [37:23<00:37,  4.67s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.42it/s][A
                                                                                                                                       [A 95%|██████████████████████████████████████████████████████████████████████████████████████████▊     | 121/128 [39:48<05:30, 47.17s/it] 95%|███████████████████████████████████████████████████████████████████████████████████████████▌    | 122/128 [39:49<03:19, 33.30s/it] 96%|████████████████████████████████████████████████████████████████████████████████████████████▎   | 123/128 [39:49<01:57, 23.59s/it] 97%|█████████████████████████████████████████████████████████████████████████████████████████████   | 124/128 [39:50<01:07, 16.79s/it] 98%|█████████████████████████████████████████████████████████████████████████████████████████████▊  | 125/128 [39:51<00:36, 12.03s/it] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▌ | 126/128 [39:52<00:17,  8.70s/it] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▎| 127/128 [39:53<00:06,  6.37s/it]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [39:54<00:00,  4.75s/it]{'eval_loss': 2.325411081314087, 'eval_runtime': 1.5486, 'eval_samples_per_second': 41.327, 'eval_steps_per_second': 5.166, 'epoch': 15.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 25%|█████████████████████████                                                                           | 2/8 [00:00<00:00, 10.22it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00,  6.46it/s][A
 62%|██████████████████████████████████████████████████████████████▌                                     | 5/8 [00:00<00:00,  5.95it/s][A
 75%|███████████████████████████████████████████████████████████████████████████                         | 6/8 [00:00<00:00,  5.67it/s][A
 88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 7/8 [00:01<00:00,  5.50it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.40it/s][A                                                                                                                                       
                                                                                                                                       [A100%|████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [39:56<00:00,  4.75s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.40it/s][A
                                                                                                                                       [A                                                                                                                                       100%|████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [44:59<00:00,  4.75s/it]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [45:00<00:00, 21.10s/it]
{'eval_loss': 2.3285257816314697, 'eval_runtime': 1.5455, 'eval_samples_per_second': 41.411, 'eval_steps_per_second': 5.176, 'epoch': 16.0}
{'train_runtime': 2699.0695, 'train_samples_per_second': 0.379, 'train_steps_per_second': 0.047, 'train_loss': 0.7599486401304603, 'epoch': 16.0}
model training done.
saving best model start.
saving best model done.
************************************************************
start test...
************************************************************
Traceback (most recent call last):
  File "/sise/eliorsu-group/Project-11-2023/FalseQA/src/exp-3_opt.py", line 412, in <module>
    test(save_dir)
  File "/sise/eliorsu-group/Project-11-2023/FalseQA/src/exp-3_opt.py", line 315, in test
    model = AutoModelForCausalLM.from_pretrained(model_checkpoint)
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 482, in from_pretrained
    config, kwargs = AutoConfig.from_pretrained(
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py", line 1007, in from_pretrained
    config_dict, unused_kwargs = PretrainedConfig.get_config_dict(pretrained_model_name_or_path, **kwargs)
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/configuration_utils.py", line 620, in get_config_dict
    config_dict, kwargs = cls._get_config_dict(pretrained_model_name_or_path, **kwargs)
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/configuration_utils.py", line 675, in _get_config_dict
    resolved_config_file = cached_file(
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/utils/hub.py", line 399, in cached_file
    raise EnvironmentError(
OSError: ../trained_model/exp-3/train_exp-3_scale-32_opt-2.7b_2023-11-28_16-07-25_34 does not appear to have a file named config.json. Checkout 'https://huggingface.co/../trained_model/exp-3/train_exp-3_scale-32_opt-2.7b_2023-11-28_16-07-25_34/None' for available files.
