datasets
datasets
datasets
datasets
datasets
datasets
datasets
datasets
datasets
datasets
finish imports
finish parsing

Namespace(model_parallel=True, model_name='opt-350m', seed=34, prompt_text='', max_length=128, batch_size=8, epoch=16, lr=5e-06, time_stamp='2023-11-28_18-32-44', test_only='False', scale=32, model_path='', loss_rate=1.0, token_loss=0)


************************************************************
start train...
************************************************************

The time stamp is 2023-11-28_18-32-44
load data start.
load data done.
data process start.
Map:   0%|                                                                                               | 0/64 [00:00<?, ? examples/s]Map: 100%|████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 1811.98 examples/s]
Map:   0%|                                                                                               | 0/64 [00:00<?, ? examples/s]Map: 100%|████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 2202.40 examples/s]
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
data process done.
model load start.
cuda
model load done.
set training arguments start.
set training arguments done.
data collator load start.
data collator load done.
trainer load start.
trainer load done.
model training start.
  0%|                                                                                                          | 0/128 [00:00<?, ?it/s]  1%|▊                                                                                                 | 1/128 [00:00<01:55,  1.10it/s]  2%|█▌                                                                                                | 2/128 [00:01<01:04,  1.97it/s]  2%|██▎                                                                                               | 3/128 [00:01<00:45,  2.74it/s]  3%|███                                                                                               | 4/128 [00:01<00:36,  3.40it/s]  4%|███▊                                                                                              | 5/128 [00:01<00:31,  3.89it/s]  5%|████▌                                                                                             | 6/128 [00:01<00:28,  4.29it/s]  5%|█████▎                                                                                            | 7/128 [00:02<00:26,  4.60it/s]  6%|██████▏                                                                                           | 8/128 [00:02<00:24,  4.82it/s]
  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.48it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.17it/s][A                                                                                                                                       
                                                                                                                                       [A  6%|██████▏                                                                                           | 8/128 [00:02<00:24,  4.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.17it/s][A
                                                                                                                                       [A  7%|██████▉                                                                                           | 9/128 [00:18<10:23,  5.24s/it]  8%|███████▌                                                                                         | 10/128 [00:18<07:14,  3.68s/it]  9%|████████▎                                                                                        | 11/128 [00:18<05:05,  2.61s/it]  9%|█████████                                                                                        | 12/128 [00:19<03:37,  1.87s/it] 10%|█████████▊                                                                                       | 13/128 [00:19<02:36,  1.36s/it] 11%|██████████▌                                                                                      | 14/128 [00:19<01:54,  1.01s/it] 12%|███████████▎                                                                                     | 15/128 [00:19<01:25,  1.32it/s] 12%|████████████▏                                                                                    | 16/128 [00:19<01:05,  1.70it/s]{'eval_loss': 3.8989715576171875, 'eval_runtime': 0.3207, 'eval_samples_per_second': 199.559, 'eval_steps_per_second': 24.945, 'epoch': 1.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.43it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.09it/s][A                                                                                                                                       
                                                                                                                                       [A 12%|████████████▏                                                                                    | 16/128 [00:20<01:05,  1.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.09it/s][A
                                                                                                                                       [A 13%|████████████▉                                                                                    | 17/128 [00:36<09:55,  5.37s/it] 14%|█████████████▋                                                                                   | 18/128 [00:36<06:59,  3.81s/it] 15%|██████████████▍                                                                                  | 19/128 [00:36<04:57,  2.73s/it] 16%|███████████████▏                                                                                 | 20/128 [00:36<03:32,  1.96s/it] 16%|███████████████▉                                                                                 | 21/128 [00:37<02:33,  1.43s/it] 17%|████████████████▋                                                                                | 22/128 [00:37<01:52,  1.06s/it] 18%|█████████████████▍                                                                               | 23/128 [00:37<01:23,  1.25it/s] 19%|██████████████████▏                                                                              | 24/128 [00:37<01:04,  1.62it/s]{'eval_loss': 3.4152379035949707, 'eval_runtime': 0.3199, 'eval_samples_per_second': 200.052, 'eval_steps_per_second': 25.007, 'epoch': 2.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.11it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.00it/s][A                                                                                                                                       
                                                                                                                                       [A 19%|██████████████████▏                                                                              | 24/128 [00:38<01:04,  1.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.00it/s][A
                                                                                                                                       [A 20%|██████████████████▉                                                                              | 25/128 [00:55<09:46,  5.69s/it] 20%|███████████████████▋                                                                             | 26/128 [00:55<06:52,  4.04s/it] 21%|████████████████████▍                                                                            | 27/128 [00:55<04:51,  2.89s/it] 22%|█████████████████████▏                                                                           | 28/128 [00:55<03:27,  2.08s/it] 23%|█████████████████████▉                                                                           | 29/128 [00:55<02:29,  1.51s/it] 23%|██████████████████████▋                                                                          | 30/128 [00:56<01:49,  1.11s/it] 24%|███████████████████████▍                                                                         | 31/128 [00:56<01:20,  1.20it/s] 25%|████████████████████████▎                                                                        | 32/128 [00:56<01:01,  1.56it/s]{'eval_loss': 2.980419874191284, 'eval_runtime': 0.3217, 'eval_samples_per_second': 198.912, 'eval_steps_per_second': 24.864, 'epoch': 3.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.13it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.04it/s][A                                                                                                                                       
                                                                                                                                       [A 25%|████████████████████████▎                                                                        | 32/128 [00:56<01:01,  1.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.04it/s][A
                                                                                                                                       [A 26%|█████████████████████████                                                                        | 33/128 [01:14<09:27,  5.97s/it] 27%|█████████████████████████▊                                                                       | 34/128 [01:15<06:38,  4.24s/it] 27%|██████████████████████████▌                                                                      | 35/128 [01:15<04:41,  3.02s/it] 28%|███████████████████████████▎                                                                     | 36/128 [01:15<03:19,  2.17s/it] 29%|████████████████████████████                                                                     | 37/128 [01:15<02:23,  1.58s/it] 30%|████████████████████████████▊                                                                    | 38/128 [01:15<01:44,  1.16s/it] 30%|█████████████████████████████▌                                                                   | 39/128 [01:16<01:17,  1.15it/s] 31%|██████████████████████████████▎                                                                  | 40/128 [01:16<00:58,  1.51it/s]{'eval_loss': 2.5815465450286865, 'eval_runtime': 0.3208, 'eval_samples_per_second': 199.487, 'eval_steps_per_second': 24.936, 'epoch': 4.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.50it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 27.79it/s][A                                                                                                                                       
                                                                                                                                       [A 31%|██████████████████████████████▎                                                                  | 40/128 [01:16<00:58,  1.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 27.79it/s][A
                                                                                                                                       [A 32%|███████████████████████████████                                                                  | 41/128 [01:33<08:09,  5.63s/it] 33%|███████████████████████████████▊                                                                 | 42/128 [01:33<05:44,  4.00s/it] 34%|████████████████████████████████▌                                                                | 43/128 [01:33<04:02,  2.86s/it] 34%|█████████████████████████████████▎                                                               | 44/128 [01:34<02:52,  2.05s/it] 35%|██████████████████████████████████                                                               | 45/128 [01:34<02:04,  1.49s/it] 36%|██████████████████████████████████▊                                                              | 46/128 [01:34<01:30,  1.11s/it] 37%|███████████████████████████████████▌                                                             | 47/128 [01:34<01:07,  1.21it/s] 38%|████████████████████████████████████▍                                                            | 48/128 [01:34<00:50,  1.57it/s]{'eval_loss': 2.2938392162323, 'eval_runtime': 0.3221, 'eval_samples_per_second': 198.699, 'eval_steps_per_second': 24.837, 'epoch': 5.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.55it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 27.94it/s][A                                                                                                                                       
                                                                                                                                       [A 38%|████████████████████████████████████▍                                                            | 48/128 [01:35<00:50,  1.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 27.94it/s][A
                                                                                                                                       [A 38%|█████████████████████████████████████▏                                                           | 49/128 [01:54<08:11,  6.22s/it] 39%|█████████████████████████████████████▉                                                           | 50/128 [01:54<05:44,  4.42s/it] 40%|██████████████████████████████████████▋                                                          | 51/128 [01:54<04:02,  3.15s/it] 41%|███████████████████████████████████████▍                                                         | 52/128 [01:54<02:51,  2.26s/it] 41%|████████████████████████████████████████▏                                                        | 53/128 [01:54<02:02,  1.64s/it] 42%|████████████████████████████████████████▉                                                        | 54/128 [01:55<01:28,  1.20s/it] 43%|█████████████████████████████████████████▋                                                       | 55/128 [01:55<01:05,  1.11it/s] 44%|██████████████████████████████████████████▍                                                      | 56/128 [01:55<00:49,  1.46it/s]{'eval_loss': 2.0224609375, 'eval_runtime': 0.3207, 'eval_samples_per_second': 199.587, 'eval_steps_per_second': 24.948, 'epoch': 6.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.50it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.18it/s][A                                                                                                                                       
                                                                                                                                       [A 44%|██████████████████████████████████████████▍                                                      | 56/128 [01:55<00:49,  1.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.18it/s][A
                                                                                                                                       [A 45%|███████████████████████████████████████████▏                                                     | 57/128 [02:13<06:53,  5.83s/it] 45%|███████████████████████████████████████████▉                                                     | 58/128 [02:13<04:49,  4.14s/it] 46%|████████████████████████████████████████████▋                                                    | 59/128 [02:13<03:23,  2.95s/it] 47%|█████████████████████████████████████████████▍                                                   | 60/128 [02:13<02:24,  2.12s/it] 48%|██████████████████████████████████████████████▏                                                  | 61/128 [02:13<01:43,  1.54s/it] 48%|██████████████████████████████████████████████▉                                                  | 62/128 [02:14<01:14,  1.13s/it] 49%|███████████████████████████████████████████████▋                                                 | 63/128 [02:14<00:55,  1.18it/s] 50%|████████████████████████████████████████████████▌                                                | 64/128 [02:14<00:41,  1.54it/s]{'eval_loss': 1.9621756076812744, 'eval_runtime': 0.3189, 'eval_samples_per_second': 200.699, 'eval_steps_per_second': 25.087, 'epoch': 7.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.49it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.08it/s][A                                                                                                                                       
                                                                                                                                       [A 50%|████████████████████████████████████████████████▌                                                | 64/128 [02:14<00:41,  1.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.08it/s][A
                                                                                                                                       [A 51%|█████████████████████████████████████████████████▎                                               | 65/128 [02:32<06:06,  5.81s/it] 52%|██████████████████████████████████████████████████                                               | 66/128 [02:32<04:16,  4.13s/it] 52%|██████████████████████████████████████████████████▊                                              | 67/128 [02:32<02:59,  2.95s/it] 53%|███████████████████████████████████████████████████▌                                             | 68/128 [02:32<02:07,  2.12s/it] 54%|████████████████████████████████████████████████████▎                                            | 69/128 [02:33<01:31,  1.55s/it] 55%|█████████████████████████████████████████████████████                                            | 70/128 [02:33<01:06,  1.14s/it] 55%|█████████████████████████████████████████████████████▊                                           | 71/128 [02:33<00:48,  1.17it/s] 56%|██████████████████████████████████████████████████████▌                                          | 72/128 [02:33<00:36,  1.52it/s]{'eval_loss': 1.9606739282608032, 'eval_runtime': 0.3203, 'eval_samples_per_second': 199.818, 'eval_steps_per_second': 24.977, 'epoch': 8.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.21it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 27.37it/s][A                                                                                                                                       
                                                                                                                                       [A 56%|██████████████████████████████████████████████████████▌                                          | 72/128 [02:34<00:36,  1.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 27.37it/s][A
                                                                                                                                       [A 57%|███████████████████████████████████████████████████████▎                                         | 73/128 [02:49<04:44,  5.17s/it] 58%|████████████████████████████████████████████████████████                                         | 74/128 [02:49<03:18,  3.68s/it] 59%|████████████████████████████████████████████████████████▊                                        | 75/128 [02:49<02:19,  2.64s/it] 59%|█████████████████████████████████████████████████████████▌                                       | 76/128 [02:50<01:39,  1.91s/it] 60%|██████████████████████████████████████████████████████████▎                                      | 77/128 [02:50<01:11,  1.40s/it] 61%|███████████████████████████████████████████████████████████                                      | 78/128 [02:50<00:51,  1.04s/it] 62%|███████████████████████████████████████████████████████████▊                                     | 79/128 [02:50<00:38,  1.28it/s] 62%|████████████████████████████████████████████████████████████▋                                    | 80/128 [02:50<00:28,  1.66it/s]{'eval_loss': 1.9632296562194824, 'eval_runtime': 0.3268, 'eval_samples_per_second': 195.816, 'eval_steps_per_second': 24.477, 'epoch': 9.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.15it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 27.77it/s][A                                                                                                                                       
                                                                                                                                       [A 62%|████████████████████████████████████████████████████████████▋                                    | 80/128 [02:51<00:28,  1.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 27.77it/s][A
                                                                                                                                       [A 63%|█████████████████████████████████████████████████████████████▍                                   | 81/128 [03:08<04:23,  5.61s/it] 64%|██████████████████████████████████████████████████████████████▏                                  | 82/128 [03:08<03:03,  3.98s/it] 65%|██████████████████████████████████████████████████████████████▉                                  | 83/128 [03:08<02:08,  2.84s/it] 66%|███████████████████████████████████████████████████████████████▋                                 | 84/128 [03:08<01:30,  2.05s/it] 66%|████████████████████████████████████████████████████████████████▍                                | 85/128 [03:08<01:04,  1.49s/it] 67%|█████████████████████████████████████████████████████████████████▏                               | 86/128 [03:09<00:46,  1.10s/it] 68%|█████████████████████████████████████████████████████████████████▉                               | 87/128 [03:09<00:33,  1.21it/s] 69%|██████████████████████████████████████████████████████████████████▋                              | 88/128 [03:09<00:25,  1.58it/s]{'eval_loss': 1.989830493927002, 'eval_runtime': 0.3232, 'eval_samples_per_second': 198.028, 'eval_steps_per_second': 24.753, 'epoch': 10.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.34it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.07it/s][A                                                                                                                                       
                                                                                                                                       [A 69%|██████████████████████████████████████████████████████████████████▋                              | 88/128 [03:09<00:25,  1.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.07it/s][A
                                                                                                                                       [A 70%|███████████████████████████████████████████████████████████████████▍                             | 89/128 [03:26<03:31,  5.43s/it] 70%|████████████████████████████████████████████████████████████████████▏                            | 90/128 [03:26<02:26,  3.87s/it] 71%|████████████████████████████████████████████████████████████████████▉                            | 91/128 [03:26<01:42,  2.76s/it] 72%|█████████████████████████████████████████████████████████████████████▋                           | 92/128 [03:26<01:11,  1.99s/it] 73%|██████████████████████████████████████████████████████████████████████▍                          | 93/128 [03:26<00:50,  1.45s/it] 73%|███████████████████████████████████████████████████████████████████████▏                         | 94/128 [03:27<00:36,  1.07s/it] 74%|███████████████████████████████████████████████████████████████████████▉                         | 95/128 [03:27<00:26,  1.24it/s] 75%|████████████████████████████████████████████████████████████████████████▊                        | 96/128 [03:27<00:19,  1.61it/s]{'eval_loss': 2.0137407779693604, 'eval_runtime': 0.3222, 'eval_samples_per_second': 198.635, 'eval_steps_per_second': 24.829, 'epoch': 11.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.29it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.03it/s][A                                                                                                                                       
                                                                                                                                       [A 75%|████████████████████████████████████████████████████████████████████████▊                        | 96/128 [03:27<00:19,  1.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.03it/s][A
                                                                                                                                       [A 76%|█████████████████████████████████████████████████████████████████████████▌                       | 97/128 [03:44<02:53,  5.60s/it] 77%|██████████████████████████████████████████████████████████████████████████▎                      | 98/128 [03:44<01:59,  3.98s/it] 77%|███████████████████████████████████████████████████████████████████████████                      | 99/128 [03:45<01:22,  2.85s/it] 78%|███████████████████████████████████████████████████████████████████████████                     | 100/128 [03:45<00:57,  2.05s/it]                                                                                                                                        78%|███████████████████████████████████████████████████████████████████████████                     | 100/128 [03:45<00:57,  2.05s/it] 79%|███████████████████████████████████████████████████████████████████████████▊                    | 101/128 [03:45<00:40,  1.49s/it] 80%|████████████████████████████████████████████████████████████████████████████▌                   | 102/128 [03:45<00:28,  1.10s/it] 80%|█████████████████████████████████████████████████████████████████████████████▎                  | 103/128 [03:45<00:20,  1.21it/s] 81%|██████████████████████████████████████████████████████████████████████████████                  | 104/128 [03:45<00:15,  1.58it/s]{'eval_loss': 2.0252742767333984, 'eval_runtime': 0.3209, 'eval_samples_per_second': 199.412, 'eval_steps_per_second': 24.927, 'epoch': 12.0}
{'loss': 1.7604, 'learning_rate': 1.0937500000000001e-06, 'epoch': 12.5}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.43it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 27.89it/s][A                                                                                                                                       
                                                                                                                                       [A 81%|██████████████████████████████████████████████████████████████████████████████                  | 104/128 [03:46<00:15,  1.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 27.89it/s][A
                                                                                                                                       [A 82%|██████████████████████████████████████████████████████████████████████████████▊                 | 105/128 [04:01<02:00,  5.25s/it] 83%|███████████████████████████████████████████████████████████████████████████████▌                | 106/128 [04:02<01:22,  3.73s/it] 84%|████████████████████████████████████████████████████████████████████████████████▎               | 107/128 [04:02<00:55,  2.67s/it] 84%|█████████████████████████████████████████████████████████████████████████████████               | 108/128 [04:02<00:38,  1.92s/it] 85%|█████████████████████████████████████████████████████████████████████████████████▊              | 109/128 [04:02<00:26,  1.40s/it] 86%|██████████████████████████████████████████████████████████████████████████████████▌             | 110/128 [04:02<00:18,  1.04s/it] 87%|███████████████████████████████████████████████████████████████████████████████████▎            | 111/128 [04:03<00:13,  1.28it/s] 88%|████████████████████████████████████████████████████████████████████████████████████            | 112/128 [04:03<00:09,  1.66it/s]{'eval_loss': 2.025681257247925, 'eval_runtime': 0.3216, 'eval_samples_per_second': 198.997, 'eval_steps_per_second': 24.875, 'epoch': 13.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.57it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.20it/s][A                                                                                                                                       
                                                                                                                                       [A 88%|████████████████████████████████████████████████████████████████████████████████████            | 112/128 [04:03<00:09,  1.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.20it/s][A
                                                                                                                                       [A 88%|████████████████████████████████████████████████████████████████████████████████████▊           | 113/128 [04:18<01:14,  4.99s/it] 89%|█████████████████████████████████████████████████████████████████████████████████████▌          | 114/128 [04:18<00:49,  3.55s/it] 90%|██████████████████████████████████████████████████████████████████████████████████████▎         | 115/128 [04:18<00:33,  2.54s/it] 91%|███████████████████████████████████████████████████████████████████████████████████████         | 116/128 [04:19<00:22,  1.84s/it] 91%|███████████████████████████████████████████████████████████████████████████████████████▊        | 117/128 [04:19<00:14,  1.34s/it] 92%|████████████████████████████████████████████████████████████████████████████████████████▌       | 118/128 [04:19<00:09,  1.00it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▎      | 119/128 [04:19<00:06,  1.33it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████      | 120/128 [04:19<00:04,  1.72it/s]{'eval_loss': 2.036761999130249, 'eval_runtime': 0.3186, 'eval_samples_per_second': 200.901, 'eval_steps_per_second': 25.113, 'epoch': 14.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.44it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.18it/s][A                                                                                                                                       
                                                                                                                                       [A 94%|██████████████████████████████████████████████████████████████████████████████████████████      | 120/128 [04:20<00:04,  1.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.18it/s][A
                                                                                                                                       [A 95%|██████████████████████████████████████████████████████████████████████████████████████████▊     | 121/128 [04:35<00:35,  5.03s/it] 95%|███████████████████████████████████████████████████████████████████████████████████████████▌    | 122/128 [04:35<00:21,  3.58s/it] 96%|████████████████████████████████████████████████████████████████████████████████████████████▎   | 123/128 [04:35<00:12,  2.56s/it] 97%|█████████████████████████████████████████████████████████████████████████████████████████████   | 124/128 [04:35<00:07,  1.85s/it] 98%|█████████████████████████████████████████████████████████████████████████████████████████████▊  | 125/128 [04:36<00:04,  1.36s/it] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▌ | 126/128 [04:36<00:02,  1.01s/it] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▎| 127/128 [04:36<00:00,  1.32it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [04:36<00:00,  1.70it/s]{'eval_loss': 2.050679922103882, 'eval_runtime': 0.3195, 'eval_samples_per_second': 200.326, 'eval_steps_per_second': 25.041, 'epoch': 15.0}

  0%|                                                                                                            | 0/8 [00:00<?, ?it/s][A
 50%|██████████████████████████████████████████████████                                                  | 4/8 [00:00<00:00, 33.50it/s][A
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.13it/s][A                                                                                                                                       
                                                                                                                                       [A100%|████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [04:36<00:00,  1.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 28.13it/s][A
                                                                                                                                       [A                                                                                                                                       100%|████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [05:17<00:00,  1.70it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [05:17<00:00,  2.48s/it]
{'eval_loss': 2.0524563789367676, 'eval_runtime': 0.3202, 'eval_samples_per_second': 199.865, 'eval_steps_per_second': 24.983, 'epoch': 16.0}
{'train_runtime': 317.0631, 'train_samples_per_second': 3.23, 'train_steps_per_second': 0.404, 'train_loss': 1.4966491162776947, 'epoch': 16.0}
model training done.
saving best model start.
saving best model done.
************************************************************
start test...
************************************************************
Traceback (most recent call last):
  File "/sise/eliorsu-group/Project-11-2023/FalseQA/src/exp-3_opt.py", line 412, in <module>
    test(save_dir)
  File "/sise/eliorsu-group/Project-11-2023/FalseQA/src/exp-3_opt.py", line 311, in test
    model = AutoModelForCausalLM.from_pretrained(model_checkpoint, ignore_mismatched_sizes=True)
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 482, in from_pretrained
    config, kwargs = AutoConfig.from_pretrained(
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py", line 1007, in from_pretrained
    config_dict, unused_kwargs = PretrainedConfig.get_config_dict(pretrained_model_name_or_path, **kwargs)
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/configuration_utils.py", line 620, in get_config_dict
    config_dict, kwargs = cls._get_config_dict(pretrained_model_name_or_path, **kwargs)
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/configuration_utils.py", line 675, in _get_config_dict
    resolved_config_file = cached_file(
  File "/home/ronfay/.conda/envs/project/lib/python3.10/site-packages/transformers/utils/hub.py", line 399, in cached_file
    raise EnvironmentError(
OSError: ../trained_model/exp-3/train_exp-3_scale-32_opt-350m_2023-11-28_18-32-44_34 does not appear to have a file named config.json. Checkout 'https://huggingface.co/../trained_model/exp-3/train_exp-3_scale-32_opt-350m_2023-11-28_18-32-44_34/None' for available files.
